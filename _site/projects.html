<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-a0b8f7824cab871fe7735f1fe8ba4cd9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-776afe9c53aec80eac26d0356b5fdbd4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/nutshell-1.0.7/nutshell.js"></script>
<script src="site_libs/quarto-contrib/nutshell-1.0.7/nutshell_options.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FYLF41PFGT"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FYLF41PFGT', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./favicon.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" aria-current="page"> 
<span class="menu-text">projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="software" class="level2">
<h2 class="anchored" data-anchor-id="software">Software</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/AE_logo_final.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://joss.theoj.org/papers/10.21105/joss.07626"><code>AutoEmulate</code>: Speeding up physics simulations using machine learning.</a><br>
<em>JOSS</em> (2025) | <a href="https://github.com/alan-turing-institute/autoemulate">Code</a><br>
<a href="#x-ae">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/rptr2.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12797"><code>rptR</code>: Intra-class coefficients for hierarchical models.</a><br>
<em>Methods in Ecology and Evolution</em> (2017) | <a href="https://github.com/mastoffel/rptR">Code</a><br>
<a href="#x-rp">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/venn.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://peerj.com/articles/11414/"><code>partR2</code>: <span class="math inline"><em>R</em><sup>2</sup></span> for individual fixed effects in hierarchical models.</a><br>
<em>PeerJ</em> (2021) | <a href="https://github.com/mastoffel/partR2">Code</a><br>
<a href="#x-p2">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/inbreedr3.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12588"><code>inbreedR</code>: Identity disequlibria and more.</a><br>
<em>Methods in Ecology and Evolution</em> (2016) | <a href="https://github.com/mastoffel/inbreedR">Code</a><br>
<a href="#x-in">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/gcalignr.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12588"><code>GCalignR</code>: Aligning gas chromatography samples.</a><br>
<em>Plos One (2018)</em> | <a href="https://github.com/mottensmann/GCalignR/graphs/contributors">Code</a><br>
<a href="#x-gc">:ü••</a></p>
</div>
</div>
</div>
</section>
<section id="research" class="level2">
<h2 class="anchored" data-anchor-id="research">Research</h2>
<p>selected, full list <a href="https://scholar.google.de/citations?user=58uLFHoAAAAJ&amp;hl=en&amp;oi=ao">here</a>.</p>
<section id="quantitative-and-evolutionary-genetics" class="level3">
<h3 class="anchored" data-anchor-id="quantitative-and-evolutionary-genetics">Quantitative and evolutionary genetics</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/kilda.jpg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://academic.oup.com/evlett/article/8/2/222/7327097">Exploring lethal mutations and their evolutionary dynamics.</a><br>
<em>Evol letters</em> (2024) | <a href="https://github.com/mastoffel/haplotype_homozygosity">Code</a><br>
<a href="#x-el">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/roh2.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/evl3.229">Long runs of homozygosity have a higher mutation load because their haplotypes are younger</a>.<br>
<em>Evol Letters</em> (2021) | <a href="https://github.com/mastoffel/sheep_roh">Code</a><br>
<a href="#x-roh">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/ID.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.nature.com/articles/s41467-021-23222-9">Effect size and genetic basis of inbreeding depression in the wild</a>.<br>
<em>Nature Comms</em> (2021) | <a href="https://github.com/mastoffel/sheep_ID">Code</a><br>
<a href="#x-id">:ü••</a></p>
</div>
</div>
</div>
</section>
<section id="molecular-ecology" class="level3">
<h3 class="anchored" data-anchor-id="molecular-ecology">Molecular ecology</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/nes_young.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/mec.15385">Early life gut microbiota predict extreme sex differences in Elephant Seals.</a><br>
<em>Mol Ecol</em> (2020) | <a href="https://github.com/mastoffel/nes_microbiome">Code</a><br>
<a href="#x-nes">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/pinnipeds_figure.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.nature.com/articles/s41467-018-06695-z">Industrial exploitation brought one-third of pinniped species to the edge of extinction</a>.<br>
<em>Nature Comms</em> (2018) | <a href="https://github.com/mastoffel/pinniped_bottlenecks">Code</a><br>
<a href="#x-bot">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/afs2.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.pnas.org/doi/abs/10.1073/pnas.1506076112">Skin chemicals encode clues to identify offspring, home colony and potential mates in fur seals.</a><br>
<em>PNAS</em> (2015) | <a href="https://github.com/mastoffel/seal_chemical_fingerprints/blob/master/analysis_markdown.pdf">Code</a> | Article in the <a href="https://www.sueddeutsche.de/wissen/biologie-wie-robben-einander-finden-1.2604289">Sueddeutsche Zeitung</a>.<br>
<a href="#x-chem">:ü••</a></p>
</div>
</div>
</div>
</section>
<section id="conservation-genetics" class="level3">
<h3 class="anchored" data-anchor-id="conservation-genetics">Conservation genetics</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/oryx.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.pnas.org/doi/10.1073/pnas.2210756120">Conservation management strategy impacts inbreeding and mutation load in scimitar-horned oryx.</a><br>
<em>PNAS</em> (2023) | <a href="#x-oryx">:ü••</a></p>
</div>
</div>
</div>
</section>
<section id="behavioural-ecology" class="level3">
<h3 class="anchored" data-anchor-id="behavioural-ecology">Behavioural ecology</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/snowy.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.pnas.org/doi/abs/10.1073/pnas.1620043114">Biased sex ratios and the impact of early survival on female polygyny</a>.<br>
<em>PNAS</em> (2017) | Code in Supplementary Material<br>
<a href="#x-plov">:ü••</a></p>
</div>
</div>
</div>
</section>
<section id="research-consulting" class="level3">
<h3 class="anchored" data-anchor-id="research-consulting">Research consulting</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/racehorse.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2022.0487">Impacts of systemic inbreeding in Thoroughbred racehorses.</a><br>
<em>Proceedings of the Royal Society B</em> (2022)<br>
<a href="#x-horse">:ü••</a></p>
</div>
</div>
</div>
</section>
</section>
<section id="side-projects" class="level2">
<h2 class="anchored" data-anchor-id="side-projects">Side projects</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/mining.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://www.turing.ac.uk/news/publications/data-study-group-final-report-global-witness-identifying-unregulated-mining-sites">Detecting artisanal mines in Myanmar from satellites</a><br>
<a href="#x-mi">:ü••</a></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/holmes.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://github.com/mastoffel/DeepDeductions">Code: Minimal transformer</a><br>
</p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20,85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/cat.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://github.com/mastoffel/neural_vocoder">Code: Neural Vocoder</a><br>
</p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[20, 85]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 19.1%;justify-content: center;">
<p><img src="pics/gea.jpg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 81.0%;justify-content: flex-start;">
<p><a href="https://github.com/mastoffel/gea">Code: Deep learning for genetic engineering attribution</a></p>
</div>
</div>
</div>
</section>
<section id="x-el" class="level2">
<h2 class="anchored" data-anchor-id="x-el">:x el</h2>
<p>We scanned the genomes of thousands of wild Soay sheep for embryonic lethal mutations. These mutations prevent an individual from being born, should it be unlucky enough to receive the same genetic variant from both mum and dad. We found a few and wondered how they are maintained in the population. We show that despite their negative effects, these mutations can persist when genetically linked to beneficial variants.</p>
<p><em>Authors</em> | <strong>MA Stoffel</strong>, SE Johnston, JG Pilkington, JM Pemberton</p>
</section>
<section id="x-roh" class="level2">
<h2 class="anchored" data-anchor-id="x-roh">:x roh</h2>
<p>Runs of homozygosity (ROH) are long stretches of homozygous genotypes, and turn out to be a weirdly insightful feature of the genome. The longer an ROH is, the fewer generations in the past is it‚Äôs common ancestor haplotype. We show using simulation and empirical genome data that such long ROH have a higher density of deleterious mutations, as natural selection had less time to select against them, compared to short ROH. This has been hypothesised before, but never been shown using real fitness data.</p>
<p><em>Authors</em> | <strong>MA Stoffel</strong>, SE Johnston, JG Pilkington, JM Pemberton</p>
</section>
<section id="x-id" class="level2">
<h2 class="anchored" data-anchor-id="x-id">:x id</h2>
<p>We know that inbreeding is bad for offspring fitness since <a href="https://charles-darwin.classic-literature.co.uk/the-effects-of-cross-and-self-fertilisation/">Darwin</a> or maybe even since <a href="https://en.wikipedia.org/wiki/Incest_in_the_Bible#:~:text=Incest%20in%20the%20Bible%20refers,21%2C%20but%20also%20in%20Deuteronomy.">biblical times</a>. The phenomenon is called <strong>inbreeding depression</strong> and is relevant not just for animals but also for <a href="https://www.nature.com/articles/s41467-019-12283-6">humans</a>. Studying a densely pheno- and genotyped wild population of bronze-age sheep, we show that the effects of even slight inbreeding on survival are severe. We uncover some of the underlying genetic mechanisms using a novel type of genome-wide association study to estimate the effects of deleterious mutations across the genome. This is possibly the most extensive study of its kind, outside of humans.</p>
<p><em>Authors</em> | <strong>MA Stoffel</strong>, SE Johnston, JG Pilkington, JM Pemberton</p>
</section>
<section id="x-nes" class="level2">
<h2 class="anchored" data-anchor-id="x-nes">:x nes</h2>
<p><a href="https://en.wikipedia.org/wiki/Northern_elephant_seal">:Northern elephant seals</a> have the second-largest sexual size dimorphism of any mammal (right after their Southern sister-species). Adult males can be 3-5 times as heavy as females. Why is that? Sexual selection has favored larger males because they are able to defend large harems of females on the beach against competitors.</p>
<p>In young elephant seals (pups) you can‚Äôt really spot a difference between males and females yet. However, when measuring their gut microbiome, sampled with a very long cotton swab, we find very strong sex-differences from early on. This opens the possibility for microbes to provide an adaptation to these two very different life-history strategies of female and male elephant seals.</p>
<p><em>Authors</em> | <strong>Martin A Stoffel</strong>, Karina Acevedo‚ÄêWhitehouse, Nami Morales‚ÄêDur√°n, Stefanie Grosser, Nayden Chakarov, Oliver Kr√ºger, Hazel J Nichols, Fernando R Elorriaga‚ÄêVerplancken, Joseph I Hoffman</p>
</section>
<section id="x-bot" class="level2">
<h2 class="anchored" data-anchor-id="x-bot">:x bot</h2>
<p>The scale of industrial seal hunting in the 18th-20th century was large, yet somehow overshadowed by the even larger whaling industry. Using genetics and a dataset of more than 11,000 seals, we estimate that many populations were on the edge of extinction. While only two species went extinct so far (the Carribean monk seal and the Japanese sea lion), others have lost most of their diversity.</p>
<p><em>Authors</em> | <strong>MA Stoffel</strong>, Emily Humble, AJ Paijmans, Karina Acevedo-Whitehouse, Barbara Louise Chilvers, B Dickerson, F Galimberti, Neil J Gemmell, SD Goldsworthy, HJ Nichols, Oliver Kr√ºger, S Negro, A Osborne, T Pastor, Bruce Cameron Robertson, S Sanvito, JK Schultz, ABA Shafer, Jochen BW Wolf, Joseph I Hoffman</p>
</section>
<section id="x-plov" class="level2">
<h2 class="anchored" data-anchor-id="x-plov">:x plov</h2>
<p>Around 60% of adult snowy plovers are male, leading to a mating system where females are polygynous, because they can chose. My friend Luke led this project, where we wanted to know where this sex bias comes from. Turns out, at birth its 50/50, and most of the sex-bias in adults starts in juveniles, where males have lower survival rates than females. We argue that two-sex population models (as used in our study) are underused but essential to understand population dynamics and light on the remaining mysteries around sexual selection.</p>
<p><em>Authors</em> | Luke J Eberhart-Phillips, Clemens K√ºpper, Tom EX Miller, Medardo Cruz-L√≥pez, Kathryn H Maher, Natalie Dos Remedios, <strong>Martin A Stoffel</strong>, Joseph I Hoffman, Oliver Kr√ºger, Tam√°s Sz√©kely</p>
</section>
<section id="x-chem" class="level2">
<h2 class="anchored" data-anchor-id="x-chem">:x chem</h2>
<p>Fur seal mothers have to find their own offspring in dense colonies among thousands of others when they return from their foraging trips at sea. Over distance, calls seem important but at close range sniffing is common. We showed that seal scent glands contain a mix of chemicals, which might be partially determined by genes and which make it possible to identify related individuals. To do this, we developed a new algorithm to work with gas-chromatography data from wild animals (<code>GCalignR</code>, see below) and borrowed analytical methods from psychology.</p>
<p><em>Authors</em> | <strong>Martin A Stoffel</strong>, Barbara A Caspers, Jaume Forcada, Athina Giannakara, Markus Baier, Luke Eberhart-Phillips, Caroline M√ºller, Joseph I Hoffman</p>
</section>
<section id="x-horse" class="level2">
<h2 class="anchored" data-anchor-id="x-horse">:x horse</h2>
<p>We show that genomic inbreeding reduces the changes of a Thoroughbred horse ever making it to the racecourse, and pinpoint a genomic region where homozygosity has a particularly large effect, independent of genome-wide inbreeding. Results were a paper, the full reproducible analysis and a patent for the method.</p>
<p><em>Authors</em> | Emmeline W Hill, <strong>Martin A Stoffel</strong>, Beatrice A McGivney, David E MacHugh, Josephine M Pemberton</p>
</section>
<section id="x-oryx" class="level2">
<h2 class="anchored" data-anchor-id="x-oryx">:x oryx</h2>
<p>to do</p>
<p><em>Authors</em> | sEmily Humble, <strong>Martin A. Stoffel</strong>, Kara Dicks, Alex D. Ball, Rebecca M. Gooley, Justin Chuven, Ricardo Pusey, Mohammed Al Remeithi, Klaus-Peter Koepfli, Budhan Pukazhenthi, Helen Senn, Rob Ogden</p>
</section>
<section id="x-ae" class="level2">
<h2 class="anchored" data-anchor-id="x-ae">:x ae</h2>
<p>Simulations of complex systems are slow. To speed them up for research and application, we have to emulate them, often using machine learning. This is difficult though. <code>AutoEmulate</code>‚Äôs goal is to provide a low-code platform to do all this automatically. I‚Äôve created the package and was lead developer during my time at the Turing Institute. On the left is the old hex logo.</p>
</section>
<section id="x-rp" class="level2">
<h2 class="anchored" data-anchor-id="x-rp">:x rp</h2>
<p><code>rptR</code> calculates intra-class coefficients (also called repeatabilities, hence the name) based on generalised linear mixed models. It does just that, but pretty well, and has somehow become a standard in various fields. <a href="https://badge.dimensions.ai/details/id/pub.1085199379">Hence the 191x field-citation ratio</a>.</p>
</section>
<section id="x-p2" class="level2">
<h2 class="anchored" data-anchor-id="x-p2">:x p2</h2>
<p><code>partR2</code> uses a few tricks to calculate the explained variance per fixed effect in GLMMs. There‚Äôs not much else doing this properly, so it has become quite <a href="https://badge.dimensions.ai/details/id/pub.1138356212">popular</a>. But take care: it‚Äôs key to think what exactly it is that you want to know, especally for more complicated models involving interactions etc.</p>
</section>
<section id="x-in" class="level1">
<h1>:x in</h1>
<p><code>inbreedR</code> was my first package. It translated a relatively obscure population genetic metric called the <strong>identity disequilibrium</strong> (there isn‚Äôt even a Wikipedia page) into usable open-source software. It also calculates a few other practical things such as multilocus-heterozygosity efficiently for many markers (thanks to a colab with a proper mathematician)</p>
</section>
<section id="x-gc" class="level1">
<h1>:x gc</h1>
<p><code>GCalignR</code> is for field chromatography samples. These can be very noisy and difficult to align with respect to each other using normal aligners. We developed a simple, rule-based, human-in-the-loop algorithm to make this work. It‚Äôs actually quite suprising how well it works given how simple it is. Try it out if you have messy field samples.</p>
</section>
<section id="x-mi" class="level1">
<h1>:x mi</h1>
<p>We collaborated with Global Witness in a short project that used satellite images to detect unregulated rare-earth mining sites in Myanmar.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>